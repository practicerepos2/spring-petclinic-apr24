pipeline{
    agent{
        label "spc"
    }
    parameters{
        choice(name: "Maven_Goal", choices:['package','clean package'] )
    }
    triggers{
        pollSCM('* * * * *')
    }
    stages{
        stage("git"){
            steps{
                git url: 'https://github.com/practicerepos2/spring-petclinic-apr24.git' ,
                branch: "main"
            }
        }
        stage("build"){
            steps{
                mail bcc: '', body: 'Build Started', cc:'', from: '', replyTo: '', subject: 'Build Started', to: 'all@rajtech.io'
                sh "mvn ${params.Maven_Goal}"
                junit testResults:'**/surefire-reports/*.xml'
                archive '**/target/spring-petclinic-*.jar'
                mail bcc: '', body: 'Build Completed', cc: '', from: '', replyTo: '', subject: 'Build completed', to: 'all@rajtech.io'
            }
        }
    }
}   